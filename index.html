<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

	<title>PC-Shop</title>
	<style>
		body {
			font-family: Arial, sans-serif;
			margin: 0;
			padding: 20px;
			background-color: #f4f4f4;
		}

		h1 {
			text-align: center;
		}

		.product-grid {
			display: grid;
			grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
			gap: 20px;
			margin-top: 30px;
		}

		.product-tile {
			background: #fff;
			border-radius: 8px;
			overflow: hidden;
			box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
			display: flex;
			flex-direction: column;
			transition: transform 0.2s ease;
		}

		.product-tile:hover {
			transform: translateY(-5px);
		}

		.product-image {
			width: 100%;
			height: 180px;
			/*background-color: #ddd;*/
			background-image: url('https://via.placeholder.com/300x180?text=Product+Image');
			background-size: cover;
			background-position: center;
		}

		.img-cl {
			height: 220px;
			display: flex;
			justify-content: center;
			align-items: center;
			background-color: #f0f0f0;
			overflow: hidden;
		}

		.img-cl img {
			max-width: 100%;
			max-height: 100%;
			object-fit: contain;
		}


		.product-details {
			padding: 15px;
			flex-grow: 1;
			display: flex;
			flex-direction: column;
			justify-content: space-between;
		}

		.product-title {
			font-size: 1.1em;
			margin-bottom: 10px;
			font-weight: bold;
		}

		.product-description {
			font-size: 0.9em;
			color: #555;
			margin-bottom: 10px;
		}

		.product-meta {
			font-size: 0.8em;
			color: #777;
		}

		/* Product rating styling */
		.product-rating {
			margin-bottom: 10px;
		}

		.product-rating i {
			color: #ffc107;
			font-size: 14px;
			margin-right: 2px;
		}

		.product-rating i.fa-star {
			color: #ffc107;
		}

		.product-rating i.fa-star-half-o {
			color: #ffc107;
		}

		.product-rating i.fa-star-o {
			color: #ddd;
		}

		/* Custom Alert Box */
		.custom-alert {
			position: fixed;
			top: 20px;
			right: 20px;
			background: #fff;
			border-radius: 8px;
			box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
			padding: 15px 20px;
			z-index: 9999;
			transform: translateX(400px);
			transition: transform 0.3s ease;
			max-width: 300px;
			border-left: 4px solid #D10024;
		}

		.custom-alert.show {
			transform: translateX(0);
		}

		.custom-alert.success {
			border-left-color: #28a745;
		}

		.custom-alert.error {
			border-left-color: #dc3545;
		}

		.custom-alert.info {
			border-left-color: #17a2b8;
		}

		.custom-alert .alert-content {
			display: flex;
			align-items: center;
			gap: 10px;
		}

		.custom-alert .alert-icon {
			font-size: 18px;
			color: #D10024;
		}

		.custom-alert.success .alert-icon {
			color: #28a745;
		}

		.custom-alert.error .alert-icon {
			color: #dc3545;
		}

		.custom-alert.info .alert-icon {
			color: #17a2b8;
		}

		.custom-alert .alert-message {
			font-size: 14px;
			color: #333;
			font-weight: 500;
		}
	</style>


	<!-- Google font -->
	<link href="https://fonts.googleapis.com/css?family=Montserrat:400,500,700" rel="stylesheet">

	<!-- Bootstrap -->
	<link type="text/css" rel="stylesheet" href="css/bootstrap.min.css" />

	<!-- Slick -->
	<link type="text/css" rel="stylesheet" href="css/slick.css" />
	<link type="text/css" rel="stylesheet" href="css/slick-theme.css" />

	<!-- nouislider -->
	<link type="text/css" rel="stylesheet" href="css/nouislider.min.css" />

	<!-- Font Awesome Icon -->
	<link rel="stylesheet" href="css/font-awesome.min.css">

	<!-- Custom stlylesheet -->
	<link type="text/css" rel="stylesheet" href="css/style.css" />

	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
		  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
		  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->
	<script src="js/jquery.min.js"></script>
	<script src="js/dataSource.js"></script>

</head>

<body>
	<!-- HEADER -->
	<header>
		<!-- TOP HEADER -->
		<div id="top-header">
			<div class="container">
				<ul class="header-links pull-left">
					<li><a href="#"><i class="fa fa-phone"></i> +8801706782347</a></li>
					<li><a href="#"><i class="fa fa-envelope-o"></i> sahidtanzid2014@gmail.com</a></li>
					<li><a href="#"><i class="fa fa-map-marker"></i> Rajshshi, Bangladesh</a></li>
				</ul>
				<ul class="header-links pull-right">
					<li><a href="profile.html"><i class="fa fa-user-o"></i> Profile</a></li>
					<li><a href="login.html" id="auth-link"><i class="fa fa-user-o auth-link"></i> LogIn</a></li>
				</ul>
			</div>
		</div>
		<!-- /TOP HEADER -->

		<!-- MAIN HEADER -->
		<div id="header">
			<!-- container -->
			<div class="container">
				<!-- row -->
				<div class="row">
					<!-- LOGO -->
					<div class="col-md-3">
						<div class="header-logo">
							<a href="index.html" class="logo" style="color:transparent; cursor:pointer; ">
								<span style="
									font-size: xxx-large;
									color: #D10024;
								">PC-Shop</span>
							</a>
						</div>
					</div>
					<!-- /LOGO -->

					<!-- SEARCH BAR -->
					<div class="col-md-6">
						<div class="header-search">
							<form id="headerSearchForm" onsubmit="performSearch(event)">
								<select class="input-select" name="search-category" id="search-category"
									title="Select category">
									<option value="">All Categories</option>
								</select>
								<input class="input" id="header-search-input" placeholder="Search here"
									name="search-term">
								<button type="submit" class="search-btn">Search</button>
							</form>
						</div>
					</div>
					<!-- /SEARCH BAR -->

					<!-- ACCOUNT -->
					<div class="col-md-3 clearfix">
						<div class="header-ctn">
							<!-- Wishlist -->
							<div>
								<a href="wishlist-page.html">
									<i class="fa fa-heart-o"></i>
									<span>Your Wishlist</span>
									<div class="qty" id="wishlist-count">0</div>
								</a>
							</div>
							<!-- /Wishlist -->

							<!-- Cart -->
							<div class="header-cart">
								<a class="" data-toggle="" onclick="handleCartClick(event)">
									<i class="fa fa-shopping-cart"></i>
									<span>Your Cart</span>
									<div class="qty" id="cart-count">0</div>
								</a>
							</div>
							<!-- /Cart -->

							<!-- Menu Toogle -->
							<div class="menu-toggle">
								<a href="#">
									<i class="fa fa-bars"></i>
									<span>Menu</span>
								</a>
							</div>
							<!-- /Menu Toogle -->
						</div>
					</div>
					<!-- /ACCOUNT -->
				</div>
				<!-- row -->
			</div>
			<!-- container -->
		</div>
		<!-- /MAIN HEADER -->
	</header>
	<!-- /HEADER -->

	<!-- Custom Alert Box -->
	<div id="customAlert" class="custom-alert" style="display: none;">
		<div class="alert-content">
			<i class="alert-icon fa fa-info-circle"></i>
			<span class="alert-message">Message here</span>
		</div>
	</div>



	<!-- HOT DEAL SECTION -->
	<div id="hot-deal" class="section">

		<div class="container">

			<div class="row">
				<div class="col-md-12">
					<div class="hot-deal">
						<ul class="hot-deal-countdown">
							<li>
								<div>
									<h3>02</h3>
									<span>Days</span>
								</div>
							</li>
							<li>
								<div>
									<h3>10</h3>
									<span>Hours</span>
								</div>
							</li>
							<li>
								<div>
									<h3>34</h3>
									<span>Mins</span>
								</div>
							</li>
							<li>
								<div>
									<h3>60</h3>
									<span>Secs</span>
								</div>
							</li>
						</ul>
						<h2 class="text-uppercase">hot deal this week</h2>
						<p>New Collection Up to 50% OFF</p>
						<a class="primary-btn cta-btn" href="store.html">Shop now</a>
					</div>
				</div>
			</div>

		</div>

	</div>
	<!-- /HOT DEAL SECTION -->

	<!-- SECTION -->
	<div class="section">
		<!-- container -->
		<div class="container">
			<!-- row -->
			<div class="row">
				<!-- shop -->
				<a href="store.html?category=b1e2c3d4-5678-4abc-9def-1234567890ab">
					<div class="col-md-4 col-xs-6">
						<div class="shop">
							<div class="shop-img">
								<img src="./img/shop01.png" alt="">
							</div>
							<div class="shop-body">
								<h3>Laptop<br>Collection</h3>
								<a href="store.html?category=b1e2c3d4-5678-4abc-9def-1234567890ab" class="cta-btn">Shop now <i class="fa fa-arrow-circle-right"></i></a>
							</div>
						</div>
					</div>
				</a>
				<!-- /shop -->

				<!-- shop -->
				<a href="store.html?category=d32721e7-21b6-4b80-878b-a9939ea93e44">
					<div class="col-md-4 col-xs-6">
						<div class="shop">
							<div class="shop-img">
								<img src="./img/shop03.png" alt="">
							</div>
							<div class="shop-body">
								<h3>Accessories<br>Collection</h3>
								<a href="store.html?category=d32721e7-21b6-4b80-878b-a9939ea93e44" class="cta-btn">Shop now <i class="fa fa-arrow-circle-right"></i></a>
							</div>
						</div>
					</div>
				</a>
				<!-- /shop -->

				<!-- shop -->
				<a href="store.html?category=a699d8eb-2cfe-45b1-a7e6-e6f41bb73d24">
					<div class="col-md-4 col-xs-6">
						<div class="shop">

							<div class="shop-img">
								<img src="./img/shop02.png" alt="">
							</div>
							<div class="shop-body">
								<h3>Peripherals<br>Collection</h3>
								<a href="store.html?category=a699d8eb-2cfe-45b1-a7e6-e6f41bb73d24" class="cta-btn">Shop now <i class="fa fa-arrow-circle-right"></i></a>
							</div>
						</div>
					</div>
				</a>
				<!-- /shop -->
			</div>
			<!-- /row -->
		</div>
		<!-- /container -->
	</div>
	<!-- /SECTION -->

	<!-- SECTION -->
	<div class="section">
		<!-- container -->
		<div class="container">
			<!-- row -->
			<div class="row">

				<!-- section title -->
				<div class="col-md-12">
					<div class="section-title">
						<h3 class="title">New Products</h3>
						<div class="section-nav">
							<ul class="section-tab-nav tab-nav">
								<li class="active"><a data-toggle="tab" href="#tab1">Laptops</a></li>
								<li><a data-toggle="tab" href="#tab1">Smartphones</a></li>
								<li><a data-toggle="tab" href="#tab1">Cameras</a></li>
								<li><a data-toggle="tab" href="#tab1">Accessories</a></li>
							</ul>
						</div>
					</div>
				</div>
				<!-- /section title -->

				<!-- Products tab & slick -->
				<div class="col-md-12">
					<div class="row">
						<div class="products-slick" data-nav="#slick-nav-1" id="productsContainer">

						</div>
						<div id="slick-nav-1" class="products-slick-nav"></div>
					</div>
				</div>
			</div>
			<!-- Products tab & slick -->
		</div>
		<!-- /row -->
	</div>
	<!-- /container -->
	</div>
	<!-- /SECTION -->





	<!-- SECTION -->

	<!-- /SECTION -->


	<!-- FOOTER -->
	<footer id="footer">
		<!-- top footer -->
		<div class="section">
			<!-- container -->
			<div class="container">
				<!-- row -->
				<div class="row">
					<div class="col-md-3 col-xs-6">
						<div class="footer">
							<h3 class="footer-title">About Us</h3>
							<p>We provide high-quality PC components for gamers, builders, and tech enthusiasts. From
								GPUs to cooling systems, we're your trusted source for performance and reliability.</p>
							<ul class="footer-links">
								<li><a href="#"><i class="fa fa-map-marker"></i>Rajshshi, Bangladesh</a></li>
								<li><a href="#"><i class="fa fa-phone"></i>+8801706782347</a></li>
								<li><a href="#"><i class="fa fa-envelope-o"></i>sahidtanzid2014@gmail.com</a></li>
							</ul>
						</div>
					</div>

					<div class="col-md-3 col-xs-6">
						<div class="footer">
							<h3 class="footer-title">Categories</h3>
							<ul class="footer-links">
								<li><a href="#">Hot deals</a></li>
								<li><a href="#">Laptops</a></li>
								<li><a href="#">Smartphones</a></li>
								<li><a href="#">Cameras</a></li>
								<li><a href="#">Accessories</a></li>
							</ul>
						</div>
					</div>

					<div class="clearfix visible-xs"></div>

					<div class="col-md-3 col-xs-6">
						<div class="footer">
							<h3 class="footer-title">Information</h3>
							<ul class="footer-links">
								<li><a href="#">About Us</a></li>
								<li><a href="#">Contact Us</a></li>
								<li><a href="#">Privacy Policy</a></li>
								<li><a href="#">Orders and Returns</a></li>
								<li><a href="#">Terms & Conditions</a></li>
							</ul>
						</div>
					</div>

					<div class="col-md-3 col-xs-6">
						<div class="footer">
							<h3 class="footer-title">Service</h3>
							<ul class="footer-links">
								<li><a href="#">My Account</a></li>
								<li><a href="#">View Cart</a></li>
								<li><a href="#">Wishlist</a></li>
								<li><a href="#">Track My Order</a></li>
								<li><a href="#">Help</a></li>
							</ul>
						</div>
					</div>
				</div>
				<!-- /row -->
			</div>
			<!-- /container -->
		</div>
		<!-- /top footer -->

		<!-- bottom footer -->
		<div id="bottom-footer" class="section">
			<div class="container">
				<!-- row -->
				<div class="row">
					<div class="col-md-12 text-center">
						<ul class="footer-payments">
							<li><a href="#"><i class="fa fa-cc-visa"></i></a></li>
							<li><a href="#"><i class="fa fa-c#D10024it-card"></i></a></li>
							<li><a href="#"><i class="fa fa-cc-paypal"></i></a></li>
							<li><a href="#"><i class="fa fa-cc-mastercard"></i></a></li>
							<li><a href="#"><i class="fa fa-cc-discover"></i></a></li>
							<li><a href="#"><i class="fa fa-cc-amex"></i></a></li>
						</ul>
						<span class="copyright">
							<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
							Copyright &copy;
							<script>document.write(new Date().getFullYear());</script> All rights reserved
							<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
						</span>
					</div>
				</div>
				<!-- /row -->
			</div>
			<!-- /container -->
		</div>
		<!-- /bottom footer -->
	</footer>
	<!-- /FOOTER -->

	<!-- jQuery Plugins -->
	<script src="js/bootstrap.min.js"></script>
	<script src="js/slick.min.js"></script>
	<script src="js/nouislider.min.js"></script>
	<script src="js/jquery.zoom.min.js"></script>
	<script src="js/function.js"></script>
	<script src="js/main.js"></script>


	<script>
		// Custom Alert Function
		function showCustomAlert(message, type = 'info') {
			const alertBox = document.getElementById('customAlert');
			const alertIcon = alertBox.querySelector('.alert-icon');
			const alertMessage = alertBox.querySelector('.alert-message');

			// Set message
			alertMessage.textContent = message;

			// Set type and icon
			alertBox.className = `custom-alert ${type}`;

			switch (type) {
				case 'success':
					alertIcon.className = 'alert-icon fa fa-check-circle';
					break;
				case 'error':
					alertIcon.className = 'alert-icon fa fa-times-circle';
					break;
				case 'info':
				default:
					alertIcon.className = 'alert-icon fa fa-info-circle';
					break;
			}

			// Show alert
			alertBox.style.display = 'block';
			setTimeout(() => {
				alertBox.classList.add('show');
			}, 300);

			// Auto hide after 2 seconds
			setTimeout(() => {
				alertBox.classList.remove('show');
				setTimeout(() => {
					alertBox.style.display = 'none';
				}, 300);
			}, 2000);
		}

		// ========================================
		// WISHLIST FUNCTIONALITY
		// ========================================

		// Get wishlist from current user
		function getWishlist() {
			const user = getCurrentUser();
			return user && Array.isArray(user.wishlist) ? user.wishlist : [];
		}

		// Save wishlist to current user
		function saveWishlist(wishlist) {
			const user = getCurrentUser();
			if (user) {
				user.wishlist = wishlist;
				setCurrentUser(user);
			}
			updateWishlistCount();
		}

		// Function to add product to wishlist
		function addToWishlist(productId) {
			const product = dataSource.products.find(p => p.productid === productId);
			if (!product) {
				console.error('Product not found:', productId);
				showCustomAlert('Product not found!', 'error');
				return false;
			}
			const wishlist = getWishlist();
			if (!wishlist.includes(productId)) {
				wishlist.push(productId);
				saveWishlist(wishlist);
				showCustomAlert(`Added ${product.productname} to wishlist!`, 'success');
				return true;
			} else {
				showCustomAlert('Product is already in your wishlist!', 'info');
				return false;
			}
		}

		// Update wishlist count in header
		function updateWishlistCount() {
			const wishlist = getWishlist();
			const countElement = document.getElementById('wishlist-count');
			if (countElement) {
				countElement.textContent = wishlist.length;
			}
		}

		// ========================================
		// CART FUNCTIONALITY
		// ========================================

		// Get cart from current user
		function getCart() {
			const user = getCurrentUser();
			return user && Array.isArray(user.cartItems) ? user.cartItems : [];
		}

		// Save cart to current user
		function saveCart(cart) {
			const user = getCurrentUser();
			if (user) {
				user.cartItems = cart;
				setCurrentUser(user);
			}
			updateCartCount();
		}

		// Function to add product to cart
		function addToCart(productId) {
			const product = dataSource.products.find(p => p.productid === productId);
			if (!product) {
				console.error('Product not found:', productId);
				showCustomAlert('Product not found!', 'error');
				return false;
			}
			const cart = getCart();
			const existingItem = cart.find(item => item.productId === productId);
			if (existingItem) {
				existingItem.quantity += 1;
			} else {
				cart.push({
					productId: productId,
					quantity: 1,
					addedAt: new Date().toISOString()
				});
			}
			saveCart(cart);
			showCustomAlert(`Added ${product.productname} to cart!`, 'success');
			return true;
		}

		// Update cart count in header
		function updateCartCount() {
			const cart = getCart();
			const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
			const countElement = document.getElementById('cart-count');
			if (countElement) {
				countElement.textContent = totalItems;
			}
		}

		// Handle cart click - redirect to checkout if cart has items
		function handleCartClick(event) {
			const cart = getCart();
			const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
			event.preventDefault();
			event.stopPropagation();
			if (totalItems > 0) {
				
				// Redirect to checkout page
				window.location.href = 'checkout.html';
			}
			else {
				// Show custom modal saying cart is empty
				showCustomAlert('Your cart is empty!', 'info');
			}
			// If cart is empty, let the dropdown open normally
		}

		// ========================================
		// QUICK VIEW FUNCTIONALITY
		// ========================================

		// Generate product image based on type
		function getProductImage(productType, productName='') {
			if (productType === "CPU") {
				return "cpu.png";
			} else if (productType === "GPU") {
				return "gpu.png";
			} else if (productType === "RAM") {
				return "ram.png";
			} else if (productType === "Device") {
				return "shop01.png";
			} else if (productType === "Storage") {
				if (productName.toLowerCase().includes("ssd")) {
					return "ssd.png";
				} 
				else  {
					return "hdd.png";
				}
			} else {
				return "default.png";
			}
		}

		// Generate star rating HTML
		function generateStarRating(rating) {
			const fullStars = Math.floor(rating);
			const hasHalfStar = rating % 1 >= 0.5;
			const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);

			let starsHTML = '';

			// Full stars
			for (let i = 0; i < fullStars; i++) {
				starsHTML += '<i class="fa fa-star"></i>';
			}

			// Half star
			if (hasHalfStar) {
				starsHTML += '<i class="fa fa-star-half-o"></i>';
			}

			// Empty stars
			for (let i = 0; i < emptyStars; i++) {
				starsHTML += '<i class="fa fa-star-o"></i>';
			}

			return starsHTML;
		}

		// Function to open quick view
		function openQuickView(productId) {
			const product = dataSource.products.find(p => p.productid === productId);
			if (!product) {
				console.error('Product not found:', productId);
				showCustomAlert('Product not found!', 'error');
				return;
			}

			showCustomAlert(`Quick view for ${product.productname} - Price: ৳${product.finalprice}`, 'info');
		}

		// Function to add to compare
		function addToCompare(productId) {
			const product = dataSource.products.find(p => p.productid === productId);
			if (product) {
				showCustomAlert(`Added ${product.productname} to compare list!`, 'success');
				console.log('Added to compare:', product);
				return true;
			}
			showCustomAlert('Product not found!', 'error');
			return false;
		}

		$(document).ready(function () {

			console.log('from index.html');
			console.log(dataSource);
			console.log(users);
			console.log(orders);

			// Check for data in localStorage and update dataSource.js variables if found
			if (localStorage.getItem(STORAGE_KEYS.ALL_PRODUCTS)) {
				try {
					dataSource.products = JSON.parse(localStorage.getItem(STORAGE_KEYS.ALL_PRODUCTS));
				} catch (e) {
					console.error('Failed to parse ALL_PRODUCTS from localStorage:', e);
				}
			}
			else {
				localStorage.setItem(STORAGE_KEYS.ALL_PRODUCTS, JSON.stringify(dataSource.products));
			}
			if (localStorage.getItem(STORAGE_KEYS.ORDERS)) {
				try {
					orders = JSON.parse(localStorage.getItem(STORAGE_KEYS.ORDERS));
				} catch (e) {
					console.error('Failed to parse ORDERS from localStorage:', e);
				}
			}
			else {
				localStorage.setItem(STORAGE_KEYS.ORDERS, JSON.stringify(orders));
			}
			if (localStorage.getItem(STORAGE_KEYS.USERS)) {
				try {
					users = JSON.parse(localStorage.getItem(STORAGE_KEYS.USERS));
				} catch (e) {
					console.error('Failed to parse USER from localStorage:', e);
				}
			}
			else{
				localStorage.setItem(STORAGE_KEYS.USERS, JSON.stringify(users));
			}


			//render_products('');

			// $.ajax({
			// 	url: 'https://localhost:7111/api/product',  // or /api/products if that's your correct endpoint
			// 	type: 'GET',
			// 	success: function (products) {
			// 		// Assuming products is an array of objects
			// 		let html = '';
			// 		console.log(products)
			// 		all_products = products;
			// 		render_products(products);
			// 		render_top_products(products);

			// 		// $('#productsTableBody').html(html);
			// 	},
			// 	error: function (xhr, status, error) {
			// 		console.error('Error fetching products:', xhr.responseText);
			// 		alert('Failed to load products.');
			// 	}
			// });


			let html = '';
			// console.log(dataSource.products)
			// all_products = dataSource.products;
			render_products(dataSource.products);
			// render_top_products(dataSource.products);

			// Populate header search categories
			populateHeaderCategories();

			// Update wishlist count
			updateWishlistCount();

			// Update cart count
			updateCartCount();

		});

		// Function to populate header search categories from dataSource
		function populateHeaderCategories() {
			const categorySelect = document.getElementById('search-category');
			if (categorySelect && dataSource.categories) {
				dataSource.categories.forEach(category => {
					const option = document.createElement('option');
					option.value = category.category_id;
					option.textContent = category.categoryname;
					categorySelect.appendChild(option);
				});
			}
		}

		// Function to perform search and redirect to store page
		function performSearch(event) {
			event.preventDefault();

			const searchTerm = document.getElementById('header-search-input').value.trim();
			const selectedCategory = document.getElementById('search-category').value;

			// Build URL with search parameters
			let url = 'store.html';
			const params = new URLSearchParams();

			if (searchTerm) {
				params.append('search', searchTerm);
			}

			if (selectedCategory) {
				params.append('category', selectedCategory);
			}

			// Add parameters to URL if any exist
			if (params.toString()) {
				url += '?' + params.toString();
			}

			// Redirect to store page with search parameters
			window.location.href = url;
		}

		function render_products(products) {
			var $container = $("#productsContainer");

			// Remove existing slick carousel if active
			if ($container.hasClass("slick-initialized")) {
				$container.slick("unslick");
			}

			const top6 = products
				.filter(p => p.product_created_on) // remove null/undefined dates
				.sort((a, b) => new Date(b.product_created_on) - new Date(a.product_created_on)) // newest first
				.slice(0, 6); // top 6


			// Clear the container
			$container.empty();

			// Add products
			$.each(products, function (index, product) {

				// console.log(product.producttypename);

				let img = getProductImage(product.producttypename, product.productname);
				var productHTML = `
					<div class="product">
						<div class="product-img">
							<img style="width: 260px; height: 200px; object-fit: cover; border-radius: 8px;" src="./img/${img}" alt="">
							<div class="product-label"><span class="sale">-${product.discountprice} ৳</span>
								<span class="new">NEW</span>
							</div>
						</div>
						<div class="product-body">
							<p class="product-category">${product.producttypename}</p>
							<h3 class="product-name"><a href="product.html">${product.productname}</a></h3>
							<h4 class="product-price">৳${product.salesprice ?? 1200} <del class="product-old-price">৳${product.finalprice ?? 1200 + 200}</del></h4>
							<div class="product-rating">
								${generateStarRating(product.rating || 0)}
								<span style="margin-left: 5px; font-size: 12px; color: #666;">(${product.rating ? product.rating.toFixed(1) : '0.0'})</span>
							</div>
							<div class="product-btns">
								<button class="add-to-wishlist" onclick="addToWishlist('${product.productid}')" title="Add to wishlist">
									<i class="fa fa-heart-o"></i>
								</button>
								<button class="quick-view" onclick="openQuickView('${product.productid}')" title="Quick view">
									<i class="fa fa-eye"></i>
								</button>
							</div>
						</div>
						<div class="add-to-cart">
							<button class="add-to-cart-btn" onclick="addToCart('${product.productid}')">
								<i class="fa fa-shopping-cart"></i> add to cart
							</button>
						</div>
					</div>`;
				$container.append(productHTML);
			});

			// Reinitialize Slick carousel
			$container.slick({
				slidesToShow: 4,
				slidesToScroll: 1,
				autoplay: true,
				infinite: true,
				speed: 300,
				arrows: true,
				appendArrows: $('#slick-nav-1'),
				responsive: [
					{
						breakpoint: 991,
						settings: {
							slidesToShow: 2,
							slidesToScroll: 1,
						}
					},
					{
						breakpoint: 480,
						settings: {
							slidesToShow: 1,
							slidesToScroll: 1,
						}
					}
				]
			});
		}

		function render_top_products(products) {
			var $container = $("#topSellingProduct");

			// Remove existing slick carousel if active
			if ($container.hasClass("slick-initialized")) {
				$container.slick("unslick");
			}

			// Clear the container
			$container.empty();

			// Add products
			$.each(products, function (index, product) {

				// console.log(product)
				var productHTML = `
					<div class="product">
						<div class="product-img">
							<img src="./img/product06.png" alt="">
							<div class="product-label">
								<span class="sale">-30%</span>
								<span class="new">NEW</span>
							</div>
						</div>
						<div class="product-body">
							<p class="product-category">${product.categoryName}</p>
							<h3 class="product-name"><a href="product.html">${product.productName}</a>
							</h3>
							<h4 class="product-price">${product.salesPrice ?? 1200} <del class="product-old-price">${product.salesPrice ?? 1200 + 200}</del></h4>
							<div class="product-rating">
								<i class="fa fa-star"></i>
								<i class="fa fa-star"></i>
								<i class="fa fa-star"></i>
								<i class="fa fa-star"></i>
								<i class="fa fa-star"></i>
							</div>
							<div class="product-btns">
								<button class="add-to-wishlist"><i class="fa fa-heart-o"></i><span
										class="tooltipp">add to wishlist</span></button>
								<button class="add-to-compare"><i class="fa fa-exchange"></i><span
										class="tooltipp">add to compare</span></button>
								<button class="quick-view"><i class="fa fa-eye"></i><span
										class="tooltipp">quick view</span></button>
							</div>
						</div>
						<div class="add-to-cart">
							<button class="add-to-cart-btn"><i class="fa fa-shopping-cart"></i> add to
								cart</button>
						</div>
					</div>
				`;
				$container.append(productHTML);
			});

			// Reinitialize Slick carousel
			$container.slick({
				slidesToShow: 4,
				slidesToScroll: 1,
				autoplay: true,
				infinite: true,
				speed: 300,
				arrows: true,
				appendArrows: $('#slick-nav-1'),
				responsive: [
					{
						breakpoint: 991,
						settings: {
							slidesToShow: 2,
							slidesToScroll: 1,
						}
					},
					{
						breakpoint: 480,
						settings: {
							slidesToShow: 1,
							slidesToScroll: 1,
						}
					}
				]
			});
		}
		function render_products_widget(products) {
			var $container = $(".product-widget");

			// Remove existing slick carousel if active
			if ($container.hasClass("slick-initialized")) {
				$container.slick("unslick");
			}

			// Clear the container
			$container.empty();

			// Add products
			$.each(products, function (index, product) {

				// console.log(product)
				var productHTML = `
					<div class="product">
						<div class="product-img">
							<img src="./img/product06.png" alt="">
							<div class="product-label">
								<span class="sale">-30%</span>
								<span class="new">NEW</span>
							</div>
						</div>
						<div class="product-body">
							<p class="product-category">${product.categoryName}</p>
							<h3 class="product-name"><a href="product.html">${product.productName}</a>
							</h3>
							<h4 class="product-price">${product.salesPrice ?? 1200} <del class="product-old-price">${product.salesPrice ?? 1200 + 200}</del></h4>
							<div class="product-rating">
								<i class="fa fa-star"></i>
								<i class="fa fa-star"></i>
								<i class="fa fa-star"></i>
								<i class="fa fa-star"></i>
								<i class="fa fa-star"></i>
							</div>
							<div class="product-btns">
								<button class="add-to-wishlist"><i class="fa fa-heart-o"></i><span
										class="tooltipp">add to wishlist</span></button>
								<button class="add-to-compare"><i class="fa fa-exchange"></i><span
										class="tooltipp">add to compare</span></button>
								<button class="quick-view"><i class="fa fa-eye"></i><span
										class="tooltipp">quick view</span></button>
							</div>
						</div>
						<div class="add-to-cart">
							<button class="add-to-cart-btn"><i class="fa fa-shopping-cart"></i> add to
								cart</button>
						</div>
					</div>
				`;
				$container.append(productHTML);
			});

			// Reinitialize Slick carousel
			$container.slick({
				slidesToShow: 4,
				slidesToScroll: 1,
				autoplay: true,
				infinite: true,
				speed: 300,
				arrows: true,
				appendArrows: $('#slick-nav-1'),
				responsive: [
					{
						breakpoint: 991,
						settings: {
							slidesToShow: 2,
							slidesToScroll: 1,
						}
					},
					{
						breakpoint: 480,
						settings: {
							slidesToShow: 1,
							slidesToScroll: 1,
						}
					}
				]
			});
		}

		// Note: updateWishlistCount function is now centralized in main.js

		function updateAuthLink() {
			const userId = getCurrentUserId();
			const authLink = document.getElementById('auth-link');
			// const authLink = document.getElementsByClassName('auth-link');
			if (!authLink) return;
			if (userId) {
				authLink.innerHTML = '<i class="fa fa-user-o"></i> Logout';
				authLink.href = '#';
				authLink.onclick = function (e) {
					e.preventDefault();
					removeCurrentUserId();
					window.location.href = 'login.html?returnUrl=' + encodeURIComponent(window.location.pathname + window.location.search);
				};
			} else {
				authLink.innerHTML = '<i class="fa fa-user-o"></i> LogIn';
				authLink.href = 'login.html?returnUrl=' + encodeURIComponent(window.location.pathname + window.location.search);
				authLink.onclick = null;
			}
		}
		document.addEventListener('DOMContentLoaded', updateAuthLink);
	</script>



</body>

</html>