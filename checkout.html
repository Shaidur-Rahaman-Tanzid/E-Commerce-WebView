<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		 <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

		<title>PC-Shop - Checkout</title>

 		<!-- Google font -->
 		<link href="https://fonts.googleapis.com/css?family=Montserrat:400,500,700" rel="stylesheet">

 		<!-- Bootstrap -->
 		<link type="text/css" rel="stylesheet" href="css/bootstrap.min.css"/>

 		<!-- Slick -->
 		<link type="text/css" rel="stylesheet" href="css/slick.css"/>
 		<link type="text/css" rel="stylesheet" href="css/slick-theme.css"/>

 		<!-- nouislider -->
 		<link type="text/css" rel="stylesheet" href="css/nouislider.min.css"/>

 		<!-- Font Awesome Icon -->
 		<link rel="stylesheet" href="css/font-awesome.min.css">

 		<!-- Custom stlylesheet -->
 		<link type="text/css" rel="stylesheet" href="css/style.css"/>

		<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
		  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
		  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->
		<script src="js/jquery.min.js"></script>
		<script src="js/dataSource.js"></script>
		<script src="js/main.js"></script>

		<style>
			/* Checkout specific styles */
			.cart-item {
				display: flex;
				align-items: center;
				padding: 15px 0;
				border-bottom: 1px solid #eee;
			}
			
			.cart-item:last-child {
				border-bottom: none;
			}
			
			.cart-item-img {
				width: 80px;
				height: 80px;
				margin-right: 15px;
				border-radius: 8px;
				overflow: hidden;
			}
			
			.cart-item-img img {
				width: 100%;
				height: 100%;
				object-fit: cover;
			}
			
			.cart-item-details {
				flex: 1;
			}
			
			.cart-item-name {
				font-weight: 600;
				margin-bottom: 5px;
				color: #333;
			}
			
			.cart-item-price {
				color: #D10024;
				font-weight: 600;
			}
			
			.quantity-controls {
				display: flex;
				align-items: center;
				gap: 10px;
				margin-top: 10px;
			}
			
			.quantity-btn {
				width: 30px;
				height: 30px;
				border: 1px solid #ddd;
				background: #fff;
				border-radius: 4px;
				cursor: pointer;
				display: flex;
				align-items: center;
				justify-content: center;
				font-weight: bold;
			}
			
			.quantity-btn:hover {
				background: #f5f5f5;
			}
			
			.quantity-input {
				width: 50px;
				height: 30px;
				text-align: center;
				border: 1px solid #ddd;
				border-radius: 4px;
			}
			
			.remove-item {
				background: none;
				border: none;
				color: #D10024;
				cursor: pointer;
				font-size: 16px;
				margin-left: 10px;
			}
			
			.remove-item:hover {
				color: #b3001f;
			}
			
			.order-summary {
				background: #f8f9fa;
				padding: 20px;
				border-radius: 8px;
				margin-bottom: 20px;
			}
			
			.order-row {
				display: flex;
				justify-content: space-between;
				padding: 8px 0;
				border-bottom: 1px solid #eee;
			}
			
			.order-row:last-child {
				border-bottom: none;
				font-weight: bold;
				font-size: 18px;
				color: #D10024;
			}
			
			.empty-cart {
				text-align: center;
				padding: 40px 20px;
				color: #666;
			}
			
			.empty-cart i {
				font-size: 4rem;
				color: #ddd;
				margin-bottom: 20px;
			}
			
			.payment-method {
				margin: 20px 0;
			}
			
			.payment-option {
				display: flex;
				align-items: center;
				padding: 15px;
				border: 2px solid #eee;
				border-radius: 8px;
				margin-bottom: 10px;
				cursor: pointer;
				transition: all 0.3s ease;
			}
			
			.payment-option:hover {
				border-color: #D10024;
			}
			
			.payment-option.selected {
				border-color: #D10024;
				background: #fff5f5;
			}
			
			.payment-option input[type="radio"] {
				margin-right: 10px;
			}
			
			.payment-option label {
				margin: 0;
				cursor: pointer;
				font-weight: 600;
			}
			
			.payment-number {
				margin-top: 10px;
				padding: 10px;
				background: #f8f9fa;
				border-radius: 4px;
				font-size: 14px;
				color: #666;
			}

			/* Custom Alert Box */
			.custom-alert {
				position: fixed;
				top: 20px;
				right: 20px;
				background: #fff;
				border-radius: 8px;
				box-shadow: 0 4px 20px rgba(0,0,0,0.15);
				padding: 15px 20px;
				z-index: 9999;
				transform: translateX(400px);
				transition: transform 0.3s ease;
				max-width: 300px;
				border-left: 4px solid #D10024;
			}
			
			.custom-alert.show {
				transform: translateX(0);
			}
			
			.custom-alert.success {
				border-left-color: #28a745;
			}
			
			.custom-alert.error {
				border-left-color: #dc3545;
			}
			
			.custom-alert.info {
				border-left-color: #17a2b8;
			}
			
			.custom-alert .alert-content {
				display: flex;
				align-items: center;
				gap: 10px;
			}
			
			.custom-alert .alert-icon {
				font-size: 18px;
				color: #D10024;
			}
			
			.custom-alert.success .alert-icon {
				color: #28a745;
			}
			
			.custom-alert.error .alert-icon {
				color: #dc3545;
			}
			
			.custom-alert.info .alert-icon {
				color: #17a2b8;
			}
			
			.custom-alert .alert-message {
				font-size: 14px;
				color: #333;
				font-weight: 500;
			}
		</style>
	</head>
	<body>
		<!-- HEADER -->
		<header>
			<!-- TOP HEADER -->
			<div id="top-header">
				<div class="container">
					<ul class="header-links pull-left">
						<li><a href="#"><i class="fa fa-phone"></i> +8801706782347</a></li>
						<li><a href="#"><i class="fa fa-envelope-o"></i> sahidtanzid2014@gmail.com</a></li>
						<li><a href="#"><i class="fa fa-map-marker"></i> Rajshshi, Bangladesh</a></li>
					</ul>
					<ul class="header-links pull-right">
						<li><a href="#"><i class="fa fa-dollar"></i> USD</a></li>
						<li><a href="#"><i class="fa fa-user-o"></i> My Account</a></li>
					</ul>
				</div>
			</div>
			<!-- /TOP HEADER -->

			<!-- MAIN HEADER -->
			<div id="header">
				<!-- container -->
				<div class="container">
					<!-- row -->
					<div class="row">
						<!-- LOGO -->
						<div class="col-md-3">
							<div class="header-logo">
								<a href="index.html" class="logo">
									<span style="
										font-size: xxx-large;
										color: #D10024;
									">PC-Shop</span>
								</a>
							</div>
						</div>
						<!-- /LOGO -->

						<!-- SEARCH BAR -->
						<div class="col-md-6">
							<div class="header-search">
								<form id="headerSearchForm" onsubmit="performSearch(event)">
									<select class="input-select" name="search-category" id="search-category" title="Select category">
										<option value="">All Categories</option>
									</select>
									<input class="input" id="header-search-input" placeholder="Search here" name="search-term">
									<button type="submit" class="search-btn">Search</button>
								</form>
							</div>
						</div>
						<!-- /SEARCH BAR -->

						<!-- ACCOUNT -->
						<div class="col-md-3 clearfix">
							<div class="header-ctn">
								<!-- Wishlist -->
								<div>
									<a href="wishlist-page.html">
										<i class="fa fa-heart-o"></i>
										<span>Your Wishlist</span>
										<div class="qty" id="wishlist-count">0</div>
									</a>
								</div>
								<!-- /Wishlist -->

								<!-- Cart -->
								<div class="dropdown">
									<a class="dropdown-toggle" data-toggle="dropdown" onclick="handleCartClick(event)">
										<i class="fa fa-shopping-cart"></i>
										<span>Your Cart</span>
										<div class="qty" id="cart-count">0</div>
									</a>
									<div class="cart-dropdown">
										<div class="cart-list" id="cart-dropdown-list">
											<!-- Cart items will be loaded here -->
										</div>
										<div class="cart-summary">
											<small id="cart-summary-text">0 Item(s) selected</small>
											<h5 id="cart-subtotal">SUBTOTAL: à§³0.00</h5>
										</div>
										<div class="cart-btns">
											<a href="checkout.html">View Cart</a>
											<a href="checkout.html">Checkout <i class="fa fa-arrow-circle-right"></i></a>
										</div>
									</div>
								</div>
								<!-- /Cart -->

								<!-- Menu Toogle -->
								<div class="menu-toggle">
									<a href="#">
										<i class="fa fa-bars"></i>
										<span>Menu</span>
									</a>
								</div>
								<!-- /Menu Toogle -->
							</div>
						</div>
						<!-- /ACCOUNT -->
					</div>
					<!-- row -->
				</div>
				<!-- container -->
			</div>
			<!-- /MAIN HEADER -->
		</header>
		<!-- /HEADER -->

		<!-- Custom Alert Box -->
		<div id="customAlert" class="custom-alert" style="display: none;">
			<div class="alert-content">
				<i class="alert-icon fa fa-info-circle"></i>
				<span class="alert-message">Message here</span>
			</div>
		</div>

		<!-- BREADCRUMB -->
		<div id="breadcrumb" class="section">
			<!-- container -->
			<div class="container">
				<!-- row -->
				<div class="row">
					<div class="col-md-12">
						<h3 class="breadcrumb-header">Checkout</h3>
						<ul class="breadcrumb-tree">
							<li><a href="index.html">Home</a></li>
							<li><a href="store.html">Store</a></li>
							<li class="active">Checkout</li>
						</ul>
					</div>
				</div>
				<!-- /row -->
			</div>
			<!-- /container -->
		</div>
		<!-- /BREADCRUMB -->

		<!-- SECTION -->
		<div class="section">
			<!-- container -->
			<div class="container">
				<!-- row -->
				<div class="row">

					<div class="col-md-7">
						<!-- Billing Details -->
						<div class="billing-details">
							<div class="section-title">
								<h3 class="title">Shipping & Billing Address</h3>
							</div>
							<div class="form-group">
								<input class="input" type="text" name="first-name" placeholder="First Name" required>
							</div>
							<div class="form-group">
								<input class="input" type="text" name="last-name" placeholder="Last Name" required>
							</div>
							<div class="form-group">
								<input class="input" type="email" name="email" placeholder="Email" required>
							</div>
							<div class="form-group">
								<input class="input" type="tel" name="phone" placeholder="Phone Number" required>
							</div>
							<div class="form-group">
								<input class="input" type="text" name="address" placeholder="Address" required>
							</div>
							<div class="form-group">
								<input class="input" type="text" name="city" placeholder="City" required>
							</div>
							<div class="form-group">
								<input class="input" type="text" name="zip-code" placeholder="ZIP Code" required>
							</div>
							<div class="form-group">
								<textarea class="input" name="notes" placeholder="Order Notes (Optional)" rows="3"></textarea>
							</div>
						</div>
						<!-- /Billing Details -->
					</div>

					<!-- Order Details -->
					<div class="col-md-5 order-details">
						<div class="section-title text-center">
							<h3 class="title">Your Order</h3>
						</div>
						
						<!-- Cart Items -->
						<div id="checkout-cart-items">
							<!-- Cart items will be loaded here -->
						</div>
						
						<!-- Order Summary -->
						<div class="order-summary">
							<div class="order-row">
								<div>Subtotal</div>
								<div id="order-subtotal">à§³0.00</div>
							</div>
							<div class="order-row">
								<div>Shipping</div>
								<div><strong>FREE</strong></div>
							</div>
							<div class="order-row">
								<div><strong>TOTAL</strong></div>
								<div><strong id="order-total">à§³0.00</strong></div>
							</div>
						</div>
						
						<!-- Payment Method -->
						<div class="payment-method">
							<h4>Payment Method</h4>
							<div class="payment-option" onclick="selectPayment('bkash')">
								<input type="radio" name="payment" id="payment-bkash" value="bkash">
								<label for="payment-bkash">BKash Payment</label>
								<!-- <div class="payment-number">Number: 01706782347</div> -->
							</div>
							<div class="payment-option" onclick="selectPayment('nagad')">
								<input type="radio" name="payment" id="payment-nagad" value="nagad">
								<label for="payment-nagad">Nagad Payment</label>
								<!-- <div class="payment-number">Number: 01706782347</div> -->
							</div>
						</div>
						
						<div class="input-checkbox">
							<input type="checkbox" id="terms" required>
							<label for="terms">
								<span></span>
								I've read and accept the <a href="#">terms & conditions</a>
							</label>
						</div>
						<button id="place-order-btn" class="primary-btn order-submit" onclick="placeOrder()">Place order</button>
					</div>
					<!-- /Order Details -->
				</div>
				<!-- /row -->
			</div>
			<!-- /container -->
		</div>
		<!-- /SECTION -->

		<!-- NEWSLETTER -->
		<div id="newsletter" class="section">
			<!-- container -->
			<div class="container">
				<!-- row -->
				<div class="row">
					<div class="col-md-12">
						<div class="newsletter">
							<p>Sign Up for the <strong>NEWSLETTER</strong></p>
							<form>
								<input class="input" type="email" placeholder="Enter Your Email">
								<button class="newsletter-btn"><i class="fa fa-envelope"></i> Subscribe</button>
							</form>
							<ul class="newsletter-follow">
								<li>
									<a href="#"><i class="fa fa-facebook"></i></a>
								</li>
								<li>
									<a href="#"><i class="fa fa-twitter"></i></a>
								</li>
								<li>
									<a href="#"><i class="fa fa-instagram"></i></a>
								</li>
								<li>
									<a href="#"><i class="fa fa-pinterest"></i></a>
								</li>
							</ul>
						</div>
					</div>
				</div>
				<!-- /row -->
			</div>
			<!-- /container -->
		</div>
		<!-- /NEWSLETTER -->

		<!-- FOOTER -->
		<footer id="footer">
			<!-- top footer -->
			<div class="section">
				<!-- container -->
				<div class="container">
					<!-- row -->
					<div class="row">
						<div class="col-md-3 col-xs-6">
							<div class="footer">
								<h3 class="footer-title">About Us</h3>
								<p>We provide high-quality PC components for gamers, builders, and tech enthusiasts. From GPUs to cooling systems, we're your trusted source for performance and reliability.</p>
								<ul class="footer-links">
									<li><a href="#"><i class="fa fa-map-marker"></i>Rajshshi, Bangladesh</a></li>
									<li><a href="#"><i class="fa fa-phone"></i>+8801706782347</a></li>
									<li><a href="#"><i class="fa fa-envelope-o"></i>sahidtanzid2014@gmail.com</a></li>
								</ul>
							</div>
						</div>

						<div class="col-md-3 col-xs-6">
							<div class="footer">
								<h3 class="footer-title">Categories</h3>
								<ul class="footer-links">
									<li><a href="#">Hot deals</a></li>
									<li><a href="#">Laptops</a></li>
									<li><a href="#">Smartphones</a></li>
									<li><a href="#">Cameras</a></li>
									<li><a href="#">Accessories</a></li>
								</ul>
							</div>
						</div>

						<div class="clearfix visible-xs"></div>

						<div class="col-md-3 col-xs-6">
							<div class="footer">
								<h3 class="footer-title">Information</h3>
								<ul class="footer-links">
									<li><a href="#">About Us</a></li>
									<li><a href="#">Contact Us</a></li>
									<li><a href="#">Privacy Policy</a></li>
									<li><a href="#">Orders and Returns</a></li>
									<li><a href="#">Terms & Conditions</a></li>
								</ul>
							</div>
						</div>

						<div class="col-md-3 col-xs-6">
							<div class="footer">
								<h3 class="footer-title">Service</h3>
								<ul class="footer-links">
									<li><a href="#">My Account</a></li>
									<li><a href="#">View Cart</a></li>
									<li><a href="wishlist-page.html">Wishlist</a></li>
									<li><a href="#">Track My Order</a></li>
									<li><a href="#">Help</a></li>
								</ul>
							</div>
						</div>
					</div>
					<!-- /row -->
				</div>
				<!-- /container -->
			</div>
			<!-- /top footer -->

			<!-- bottom footer -->
			<div id="bottom-footer" class="section">
				<div class="container">
					<!-- row -->
					<div class="row">
						<div class="col-md-12 text-center">
							<ul class="footer-payments">
								<li><a href="#"><i class="fa fa-cc-visa"></i></a></li>
								<li><a href="#"><i class="fa fa-credit-card"></i></a></li>
								<li><a href="#"><i class="fa fa-cc-paypal"></i></a></li>
								<li><a href="#"><i class="fa fa-cc-mastercard"></i></a></li>
								<li><a href="#"><i class="fa fa-cc-discover"></i></a></li>
								<li><a href="#"><i class="fa fa-cc-amex"></i></a></li>
							</ul>
							<span class="copyright">
								<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
								Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved
							<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
							</span>
						</div>
					</div>
						<!-- /row -->
				</div>
				<!-- /container -->
			</div>
			<!-- /bottom footer -->
		</footer>
		<!-- /FOOTER -->

		<!-- jQuery Plugins -->
		<script src="js/bootstrap.min.js"></script>
		<script src="js/slick.min.js"></script>
		<script src="js/nouislider.min.js"></script>
		<script src="js/jquery.zoom.min.js"></script>

		<script>
			// Custom Alert Function
			function showCustomAlert(message, type = 'info') {
				const alertBox = document.getElementById('customAlert');
				const alertIcon = alertBox.querySelector('.alert-icon');
				const alertMessage = alertBox.querySelector('.alert-message');
				
				// Set message
				alertMessage.textContent = message;
				
				// Set type and icon
				alertBox.className = `custom-alert ${type}`;
				
				switch(type) {
					case 'success':
						alertIcon.className = 'alert-icon fa fa-check-circle';
						break;
					case 'error':
						alertIcon.className = 'alert-icon fa fa-times-circle';
						break;
					case 'info':
					default:
						alertIcon.className = 'alert-icon fa fa-info-circle';
						break;
				}
				
				// Show alert
				alertBox.style.display = 'block';
				setTimeout(() => {
					alertBox.classList.add('show');
				}, 100);
				
				// Auto hide after 2 seconds
				setTimeout(() => {
					alertBox.classList.remove('show');
					setTimeout(() => {
						alertBox.style.display = 'none';
					}, 300);
				}, 2000);
			}

			// Global variables
			let cartItems = [];
			let selectedPayment = '';

			// ========================================
			// CART FUNCTIONALITY
			// ========================================

			// Get wishlist from current user
			function getWishlist() {
				const user = getCurrentUser();
				return user && Array.isArray(user.wishlist) ? user.wishlist : [];
			}
			function updateWishlistCount() {
				const wishlist = getWishlist();
				const countElement = document.getElementById('wishlist-count');
				if (countElement) {
					countElement.textContent = wishlist.length;
				}
			}
			// CART FUNCTIONALITY
			function getCart() {
				const user = getCurrentUser();
				return user && Array.isArray(user.cartItems) ? user.cartItems : [];
			}
			function saveCart(cart) {
				const user = getCurrentUser();
				if (user) {
					user.cartItems = cart;
					setCurrentUser(user);
				}
				updateCartCount();
			}
			function updateCartCount() {
				const cart = getCart();
				const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
				const countElement = document.getElementById('cart-count');
				if (countElement) {
					countElement.textContent = totalItems;
				}
			}
			function handleCartClick(event) {
				const cart = getCart();
				const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
				if (totalItems > 0) {
					// Prevent dropdown from opening
					event.preventDefault();
					event.stopPropagation();
					// Refresh the page to update cart display (since we're already on checkout)
					window.location.reload();
				}
				// If cart is empty, let the dropdown open normally
			}
			function removeFromCart(productId) {
				const cart = getCart();
				const updatedCart = cart.filter(item => item.productId !== productId);
				saveCart(updatedCart);
				loadCheckoutCart();
			}
			function loadCheckoutCart() {
				const cart = getCart();
				const container = document.getElementById('checkout-cart-items');
				
				if (cart.length === 0) {
					container.innerHTML = `
						<div class="empty-cart">
							<i class="fa fa-shopping-cart"></i>
							<h3>Your cart is empty</h3>
							<p>Add some products to your cart to continue with checkout</p>
							<a href="store.html" class="primary-btn">Continue Shopping</a>
						</div>
					`;
					document.getElementById('place-order-btn').style.display = 'none';
					return;
				}

				document.getElementById('place-order-btn').style.display = 'block';
				
				let html = '';
				let subtotal = 0;

				cart.forEach(item => {
					const product = dataSource.products.find(p => p.productid === item.productId);
					if (product) {
						const itemTotal = product.finalprice * item.quantity;
						subtotal += itemTotal;
						const img = getProductImage(product.producttypename);

						html += `
							<div class="cart-item">
								<div class="cart-item-img">
									<img src="./img/${img}" alt="${product.productname}">
								</div>
								<div class="cart-item-details">
									<div class="cart-item-name">${product.productname}</div>
									<div class="cart-item-price">à§³${product.finalprice.toFixed(2)}</div>
									<div class="quantity-controls">
										<button class="quantity-btn" onclick="updateQuantity('${product.productid}', ${item.quantity - 1})" title="Decrease quantity">-</button>
										<input type="number" class="quantity-input" value="${item.quantity}" min="1" onchange="updateQuantity('${product.productid}', parseInt(this.value))">
										<button class="quantity-btn" onclick="updateQuantity('${product.productid}', ${item.quantity + 1})" title="Increase quantity">+</button>
										<button class="remove-item" onclick="removeFromCart('${product.productid}')" title="Remove item">
											<i class="fa fa-trash"></i>
										</button>
									</div>
								</div>
								<div class="cart-item-total">
									<strong>à§³${itemTotal.toFixed(2)}</strong>
								</div>
							</div>
						`;
					}
				});

				container.innerHTML = html;
				
				// Update totals
				document.getElementById('order-subtotal').textContent = `$${subtotal.toFixed(2)}`;
				document.getElementById('order-total').textContent = `à§³${subtotal.toFixed(2)}`;
			}

			// Select payment method
			function selectPayment(method) {
				selectedPayment = method;
				
				// Update UI
				document.querySelectorAll('.payment-option').forEach(option => {
					option.classList.remove('selected');
				});
				
				event.currentTarget.classList.add('selected');
				document.getElementById(`payment-${method}`).checked = true;
			}

			// Place order
			function placeOrder() {
				const cart = getCart();
				
				if (cart.length === 0) {
					showCustomAlert('Your cart is empty!', 'error');
					return;
				}

				if (!selectedPayment) {
					showCustomAlert('Please select a payment method!', 'error');
					return;
				}

				// Validate form
				const requiredFields = ['first-name', 'last-name', 'email', 'phone', 'address', 'city', 'zip-code'];
				for (let field of requiredFields) {
					const input = document.querySelector(`input[name="${field}"]`);
					if (!input.value.trim()) {
						showCustomAlert(`Please fill in ${field.replace('-', ' ')}`, 'error');
						input.focus();
						return;
					}
				}

				if (!document.getElementById('terms').checked) {
					showCustomAlert('Please accept the terms and conditions!', 'error');
					return;
				}

				// Calculate total
				const subtotal = cart.reduce((sum, item) => {
					const product = dataSource.products.find(p => p.productid === item.productId);
					return sum + (product ? product.finalprice * item.quantity : 0);
				}, 0);

				// Create order object
				const order = {
					id: Date.now(),
					date: new Date().toISOString(),
					items: cart,
					subtotal: subtotal,
					total: subtotal,
					paymentMethod: selectedPayment,
					status: 'pending',
					customerInfo: {
						firstName: document.querySelector('input[name="first-name"]').value,
						lastName: document.querySelector('input[name="last-name"]').value,
						email: document.querySelector('input[name="email"]').value,
						phone: document.querySelector('input[name="phone"]').value,
						address: document.querySelector('input[name="address"]').value,
						city: document.querySelector('input[name="city"]').value,
						zipCode: document.querySelector('input[name="zip-code"]').value,
						notes: document.querySelector('textarea[name="notes"]').value
					}
				};

				// Save order to localStorage (in a real app, this would go to a server)
				const orders = JSON.parse(localStorage.getItem('pc_shop_orders') || '[]');
				orders.push(order);
				localStorage.setItem('pc_shop_orders', JSON.stringify(orders));

				// Clear cart
				localStorage.removeItem('pc_shop_cart');

				// Show success message
				showCustomAlert(`Order placed successfully! Order ID: ${order.id}\n\nPayment Instructions:\nPlease send à§³${order.total.toFixed(2)} to the ${selectedPayment.toUpperCase()} number provided.`, 'success');

				// Redirect to home page
				setTimeout(() => {
					window.location.href = 'index.html';
				}, 2000);
			}

			// Initialize page
			document.addEventListener('DOMContentLoaded', function() {
				// Check if dataSource is loaded
				if (typeof dataSource === 'undefined' || !dataSource.products) {
					console.error('dataSource not loaded properly');
					alert('Error: Product data not loaded. Please refresh the page.');
					return;
				}
				
				console.log('dataSource loaded successfully with', dataSource.products.length, 'products');
				
				// Populate header categories
				populateHeaderCategories();
				
				updateCartCount();
				updateWishlistCount();
				loadCheckoutCart();
			});

			// Function to populate header search categories from dataSource
			function populateHeaderCategories() {
				const categorySelect = document.getElementById('search-category');
				if (categorySelect && dataSource.categories) {
					dataSource.categories.forEach(category => {
						const option = document.createElement('option');
						option.value = category.category_id;
						option.textContent = category.categoryname;
						categorySelect.appendChild(option);
					});
				}
			}

			// Function to perform search and redirect to store page
			function performSearch(event) {
				event.preventDefault();
				
				const searchTerm = document.getElementById('header-search-input').value.trim();
				const selectedCategory = document.getElementById('search-category').value;
				
				// Build URL with search parameters
				let url = 'store.html';
				const params = new URLSearchParams();
				
				if (searchTerm) {
					params.append('search', searchTerm);
				}
				
				if (selectedCategory) {
					params.append('category', selectedCategory);
				}
				
				// Add parameters to URL if any exist
				if (params.toString()) {
					url += '?' + params.toString();
				}
				
				// Redirect to store page with search parameters
				window.location.href = url;
			}

			function updateAuthLink() {
				const userId = getCurrentUserId();
				const authLink = document.getElementById('auth-link');
				if (!authLink) return;
				if (userId) {
					authLink.innerHTML = '<i class="fa fa-user-o"></i> Logout';
					authLink.href = '#';
					authLink.onclick = function(e) {
						e.preventDefault();
						removeCurrentUserId();
						window.location.href = 'login.html?returnUrl=' + encodeURIComponent(window.location.pathname + window.location.search);
					};
				} else {
					authLink.innerHTML = '<i class="fa fa-user-o"></i> LogIn';
					authLink.href = 'login.html?returnUrl=' + encodeURIComponent(window.location.pathname + window.location.search);
					authLink.onclick = null;
				}
			}
			document.addEventListener('DOMContentLoaded', updateAuthLink);

			// Add this helper for product images
			function getProductImage(productType) {
				switch (productType) {
					case "CPU": return "cpu.png";
					case "GPU": return "gpu.png";
					case "RAM": return "ram.png";
					case "Storage": return Math.random() < 0.5 ? "ssd.png" : "hdd.png";
					default: return "default.png";
				}
			}
		</script>

	</body>
</html>
