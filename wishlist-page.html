<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Wishlist - PC-Shop</title>

    <!-- Google font -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,500,700" rel="stylesheet">

    <!-- Bootstrap -->
    <link type="text/css" rel="stylesheet" href="css/bootstrap.min.css" />

    <!-- Slick -->
    <link type="text/css" rel="stylesheet" href="css/slick.css" />
    <link type="text/css" rel="stylesheet" href="css/slick-theme.css" />

    <!-- nouislider -->
    <link type="text/css" rel="stylesheet" href="css/nouislider.min.css" />

    <!-- Font Awesome Icon -->
    <link rel="stylesheet" href="css/font-awesome.min.css">

    <!-- Custom stlylesheet -->
    <link type="text/css" rel="stylesheet" href="css/style.css" />

    <script src="js/jquery.min.js"></script>
    <script src="js/dataSource.js"></script>

    <style>
        /* Wishlist page specific styles */
        .wishlist-header {
            background: #f8f9fa;
            padding: 40px 0;
            margin-bottom: 40px;
        }

        .wishlist-title {
            color: #333;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .wishlist-subtitle {
            color: #666;
            font-size: 1.1rem;
        }

        .wishlist-empty {
            text-align: center;
            padding: 60px 20px;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .wishlist-empty i {
            font-size: 4rem;
            color: #ddd;
            margin-bottom: 20px;
        }

        .wishlist-empty h3 {
            color: #666;
            margin-bottom: 15px;
        }

        .wishlist-empty p {
            color: #999;
            margin-bottom: 25px;
        }

        .btn-shop-now {
            background: #D10024;
            color: #fff;
            padding: 12px 30px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 600;
            transition: background-color 0.3s ease;
        }

        .btn-shop-now:hover {
            background: #b3001f;
            color: #fff;
            text-decoration: none;
        }

        /* Custom Alert Box */
        .custom-alert {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            padding: 15px 20px;
            z-index: 9999;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            max-width: 300px;
            border-left: 4px solid #D10024;
        }

        .custom-alert.show {
            transform: translateX(0);
        }

        .custom-alert.success {
            border-left-color: #28a745;
        }

        .custom-alert.error {
            border-left-color: #dc3545;
        }

        .custom-alert.info {
            border-left-color: #17a2b8;
        }

        .custom-alert .alert-content {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .custom-alert .alert-icon {
            font-size: 18px;
            color: #D10024;
        }

        .custom-alert.success .alert-icon {
            color: #28a745;
        }

        .custom-alert.error .alert-icon {
            color: #dc3545;
        }

        .custom-alert.info .alert-icon {
            color: #17a2b8;
        }

        .custom-alert .alert-message {
            font-size: 14px;
            color: #333;
            font-weight: 500;
        }

        /* Product tile styling - same as store page */
        .product {
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            transition: all 0.3s ease;
            overflow: hidden;
            position: relative;
            min-height: 450px;
        }

        .product:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .product-img {
            position: relative;
            overflow: hidden;
            height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
        }

        .product-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .product:hover .product-img img {
            transform: scale(1.05);
        }

        .product-body {
            padding: 20px;
            position: relative;
            padding-bottom: 70px;
        }

        .product-category {
            color: #999;
            font-size: 12px;
            text-transform: uppercase;
            margin-bottom: 8px;
        }

        .product-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
            line-height: 1.4;
        }

        .product-name a {
            color: #333;
            text-decoration: none;
        }

        .product-name a:hover {
            color: #D10024;
        }

        .product-description {
            color: #666;
            font-size: 13px;
            line-height: 1.5;
            margin-bottom: 15px;
            min-height: 40px;
        }

        .product-price {
            font-size: 18px;
            font-weight: 700;
            color: #D10024;
            margin-bottom: 15px;
        }

        /* Product rating styling */
        .product-rating {
            margin-bottom: 10px;
        }

        .product-rating i {
            color: #ffc107;
            font-size: 14px;
            margin-right: 2px;
        }

        .product-rating i.fa-star {
            color: #ffc107;
        }

        .product-rating i.fa-star-half-o {
            color: #ffc107;
        }

        .product-rating i.fa-star-o {
            color: #ddd;
        }

        .add-to-cart1 {
            position: relative;
            bottom: 0;
            left: 0;
            right: 0;
            background: #D10024;
            color: #fff;
            padding: 15px;
            text-align: center;
            transform: translateY(0);
            transition: all 0.3s ease;
            cursor: pointer;
            z-index: 10;
        }

        .add-to-cart {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: #D10024;
            color: #fff;
            padding: 15px;
            text-align: center;
            transform: translateY(0);
            transition: all 0.3s ease;
            cursor: pointer;
            z-index: 10;
            /* border-radius: 0 0 8px 8px;
            box-shadow: 0 -2px 5px rgba(0,0,0,0.1); */
        }

        .add-to-cart:hover {
            background: #b3001f;
            /* transform: translateY(-2px);
            box-shadow: 0 -4px 10px rgba(0,0,0,0.2); */
        }

        .add-to-cart-btn {
            background: none;
            border: none;
            color: #fff;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            font-size: 14px;
            /* text-transform: uppercase;
            letter-spacing: 0.5px; */
        }

        .add-to-cart-btn:hover {
            color: #fff;
        }

        .remove-from-wishlist {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: rgba(255, 255, 255, 0.9);
            color: #D10024;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 20;
        }

        .remove-from-wishlist:hover {
            background: #D10024;
            color: #fff;
        }

        /* Product buttons */
        .product-btns {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .product:hover .product-btns {
            opacity: 1;
        }

        .product-btns button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .product-btns button:hover {
            background: #D10024;
            color: #fff;
        }

        /* Product label */
        .product-label {
            position: absolute;
            top: 15px;
            left: 15px;
        }

        .product-label .new {
            background: #D10024;
            color: #fff;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: 600;
        }

        /* Responsive */
        @media (max-width: 767.98px) {
            .wishlist-title {
                font-size: 2rem;
            }

            .product {
                margin-bottom: 20px;
            }
        }

        /* Quick View Modal Styling */
        .modal-lg {
            max-width: 900px;
        }

        .modal-content {
            border-radius: 12px;
            border: none;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            border-radius: 12px 12px 0 0;
            padding: 20px 25px;
        }

        .modal-title {
            color: #333;
            font-weight: 600;
            font-size: 18px;
        }

        .modal-body {
            padding: 25px;
        }

        .product-details-modal .product-name {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }

        .product-details-modal .product-category {
            color: #666;
            font-size: 14px;
            text-transform: uppercase;
            margin-bottom: 15px;
        }

        .product-details-modal .product-price {
            font-size: 28px;
            font-weight: 700;
            color: #D10024;
            margin-bottom: 20px;
        }

        .product-details-modal .product-description {
            color: #666;
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 25px;
        }

        .product-specs {
            margin-bottom: 25px;
        }

        .product-specs h5 {
            color: #333;
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .product-specs .table {
            margin-bottom: 0;
        }

        .product-specs .table td {
            padding: 8px 12px;
            border-top: 1px solid #f0f0f0;
            font-size: 14px;
        }

        .product-specs .table td:first-child {
            font-weight: 600;
            color: #555;
            width: 40%;
        }

        .product-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .product-actions .btn {
            flex: 1;
            min-width: 150px;
            padding: 12px 20px;
            font-weight: 600;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .product-actions .btn-primary {
            background: #D10024;
            border-color: #D10024;
        }

        .product-actions .btn-primary:hover {
            background: #b3001f;
            border-color: #b3001f;
            transform: translateY(-2px);
        }

        .product-actions .btn-outline-primary {
            color: #D10024;
            border-color: #D10024;
        }

        .product-actions .btn-outline-primary:hover {
            background: #D10024;
            border-color: #D10024;
            transform: translateY(-2px);
        }

        /* Modal rating styling */
        .product-details-modal .product-rating {
            margin-bottom: 15px;
        }

        .product-details-modal .product-rating i {
            font-size: 16px;
            margin-right: 3px;
        }

        /* Responsive modal */
        @media (max-width: 767.98px) {
            .modal-lg {
                max-width: 95%;
                margin: 10px auto;
            }

            .modal-body {
                padding: 15px;
            }

            .product-details-modal .product-name {
                font-size: 20px;
            }

            .product-details-modal .product-price {
                font-size: 24px;
            }

            .product-actions {
                flex-direction: column;
            }

            .product-actions .btn {
                min-width: auto;
            }
        }
    </style>
</head>

<body>
    <!-- HEADER -->
    <header>
        <!-- TOP HEADER -->
        <div id="top-header">
            <div class="container">
                <ul class="header-links pull-left">
                    <li><a href="#"><i class="fa fa-phone"></i> +8801706782347</a></li>
                    <li><a href="#"><i class="fa fa-envelope-o"></i> sahidtanzid2014@gmail.com</a></li>
                    <li><a href="#"><i class="fa fa-map-marker"></i> Rajshshi, Bangladesh</a></li>
                </ul>
                <ul class="header-links pull-right">
                    <li><a href="profile.html"><i class="fa fa-user-o"></i> Profile</a></li>
                    <li><a href="login.html" id="auth-link"><i class="fa fa-user-o"></i> LogIn</a></li>
                </ul>
            </div>
        </div>
        <!-- /TOP HEADER -->

        <!-- MAIN HEADER -->
        <div id="header">
            <!-- container -->
            <div class="container">
                <!-- row -->
                <div class="row">
                    <!-- LOGO -->
                    <div class="col-md-3">
                        <div class="header-logo">
                            <a href="index.html" class="logo" style="color:transparent; cursor:pointer; ">
                                <span style="
                                    font-size: xxx-large;
                                    color: #D10024;
                                ">PC-Shop</span>
                            </a>
                        </div>
                    </div>
                    <!-- /LOGO -->

                    <!-- SEARCH BAR -->
                    <div class="col-md-6">
                        <div class="header-search">
                            <form id="headerSearchForm" onsubmit="performSearch(event)">
                                <select class="input-select" name="search-category" id="search-category"
                                    title="Select category">
                                    <option value="">All Categories</option>
                                </select>
                                <input class="input" id="header-search-input" placeholder="Search here"
                                    name="search-term">
                                <button type="submit" class="search-btn">Search</button>
                            </form>
                        </div>
                    </div>
                    <!-- /SEARCH BAR -->

                    <!-- ACCOUNT -->
                    <div class="col-md-3 clearfix">
                        <div class="header-ctn">
                            <!-- Wishlist -->
                            <div>
                                <a href="wishlist-page.html">
                                    <i class="fa fa-heart-o"></i>
                                    <span>Your Wishlist</span>
                                    <div class="qty" id="wishlist-count">0</div>
                                </a>
                            </div>
                            <!-- /Wishlist -->

                            <!-- Cart -->
                            <div class="">
                                <a class="" onclick="handleCartClick(event)">
                                    <i class="fa fa-shopping-cart"></i>
                                    <span>Your Cart</span>
                                    <div class="qty" id="cart-count">0</div>
                                </a>
                                <div class="cart-dropdown">
                                    <div class="cart-list">
                                        <div class="product-widget">
                                            <div class="product-img">
                                                <img src="./img/product01.png" alt="">
                                            </div>
                                            <div class="product-body">
                                                <h3 class="product-name"><a href="product.html">product name goes
                                                        here</a></h3>
                                                <h4 class="product-price"><span class="qty">1x</span>৳980.00</h4>
                                            </div>
                                            <button class="delete" title="Remove from cart"><i
                                                    class="fa fa-close"></i></button>
                                        </div>

                                        <div class="product-widget">
                                            <div class="product-img">
                                                <img src="./img/product02.png" alt="">
                                            </div>
                                            <div class="product-body">
                                                <h3 class="product-name"><a href="product.html">product name goes
                                                        here</a></h3>
                                                <h4 class="product-price"><span class="qty">3x</span>৳980.00</h4>
                                            </div>
                                            <button class="delete" title="Remove from cart"><i
                                                    class="fa fa-close"></i></button>
                                        </div>
                                    </div>
                                    <div class="cart-summary">
                                        <small>3 Item(s) selected</small>
                                        <h5>SUBTOTAL: ৳2940.00</h5>
                                    </div>
                                    <div class="cart-btns">
                                        <a href="#">View Cart</a>
                                        <a href="checkout.html">Checkout <i class="fa fa-arrow-circle-right"></i></a>
                                    </div>
                                </div>
                            </div>
                            <!-- /Cart -->

                            <!-- Menu Toogle -->
                            <div class="menu-toggle">
                                <a href="#">
                                    <i class="fa fa-bars"></i>
                                    <span>Menu</span>
                                </a>
                            </div>
                            <!-- /Menu Toogle -->
                        </div>
                    </div>
                    <!-- /ACCOUNT -->
                </div>
                <!-- row -->
            </div>
            <!-- container -->
        </div>
        <!-- /MAIN HEADER -->
    </header>
    <!-- /HEADER -->

    <!-- Custom Alert Box -->
    <div id="customAlert" class="custom-alert" style="display: none;">
        <div class="alert-content">
            <i class="alert-icon fa fa-info-circle"></i>
            <span class="alert-message">Message here</span>
        </div>
    </div>



    <!-- WISHLIST HEADER -->
    <div class="wishlist-header">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <h1 class="wishlist-title">My Wishlist</h1>
                    <p class="wishlist-subtitle">Save your favorite products for later</p>
                </div>
            </div>
        </div>
    </div>
    <!-- /WISHLIST HEADER -->

    <!-- WISHLIST SECTION -->
    <div class="section">
        <div class="container">
            <div class="row" id="wishlist-container">
                <!-- Wishlist items will be dynamically loaded here -->
            </div>
        </div>
    </div>
    <!-- /WISHLIST SECTION -->

    <!-- Quick View Modal -->
    <div id="quickViewModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="quickViewModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h4 class="modal-title" id="quickViewModalLabel">Product Details</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="product-img-modal">
                                <img id="modalProductImg" src="" alt="Product Image"
                                    style="width: 100%; height: 300px; object-fit: cover; border-radius: 8px;">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="product-details-modal">
                                <h3 id="modalProductName" class="product-name"></h3>
                                <p id="modalProductCategory" class="product-category"></p>
                                <div id="modalProductRating" class="product-rating" style="margin-bottom: 15px;"></div>
                                <h4 id="modalProductPrice" class="product-price"></h4>
                                <p id="modalProductDescription" class="product-description"></p>

                                <div class="product-specs">
                                    <h5>Product Specifications</h5>
                                    <table class="table table-striped">
                                        <tbody>
                                            <tr>
                                                <td><strong>Brand:</strong></td>
                                                <td id="modalProductBrand"></td>
                                            </tr>
                                            <tr>
                                                <td><strong>Product Type:</strong></td>
                                                <td id="modalProductType"></td>
                                            </tr>
                                            <tr>
                                                <td><strong>Category:</strong></td>
                                                <td id="modalProductCategoryFull"></td>
                                            </tr>
                                            <tr>
                                                <td><strong>Original Price:</strong></td>
                                                <td id="modalProductOriginalPrice"></td>
                                            </tr>
                                            <tr>
                                                <td><strong>Discounted Price:</strong></td>
                                                <td id="modalProductFinalPrice"></td>
                                            </tr>
                                            <tr>
                                                <td><strong>Saving:</strong></td>
                                                <td id="modalProductDiscount"></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>

                                <div class="product-actions">
                                    <button class="btn btn-primary btn-lg" onclick="addToCartFromModal()">
                                        <i class="fa fa-shopping-cart"></i> Add to Cart
                                    </button>
                                    <!-- <button class="btn btn-outline-primary btn-lg" onclick="addToWishlistFromModal()">
                                        <i class="fa fa-heart-o"></i> Add to Wishlist
                                    </button> -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer id="footer">
        <!-- top footer -->
        <div class="section">
            <!-- container -->
            <div class="container">
                <!-- row -->
                <div class="row">
                    <div class="col-md-3 col-xs-6">
                        <div class="footer">
                            <h3 class="footer-title">About Us</h3>
                            <p>We provide high-quality PC components for gamers, builders, and tech enthusiasts. From
                                GPUs to cooling systems, we're your trusted source for performance and reliability.</p>
                            <ul class="footer-links">
                                <li><a href="#"><i class="fa fa-map-marker"></i>Rajshshi, Bangladesh</a></li>
                                <li><a href="#"><i class="fa fa-phone"></i>+8801706782347</a></li>
                                <li><a href="#"><i class="fa fa-envelope-o"></i>sahidtanzid2014@gmail.com</a></li>
                            </ul>
                        </div>
                    </div>

                    <div class="col-md-3 col-xs-6">
                        <div class="footer">
                            <h3 class="footer-title">Categories</h3>
                            <ul class="footer-links">
                                <li><a href="#">Hot deals</a></li>
                                <li><a href="#">Laptops</a></li>
                                <li><a href="#">Smartphones</a></li>
                                <li><a href="#">Cameras</a></li>
                                <li><a href="#">Accessories</a></li>
                            </ul>
                        </div>
                    </div>

                    <div class="clearfix visible-xs"></div>

                    <div class="col-md-3 col-xs-6">
                        <div class="footer">
                            <h3 class="footer-title">Information</h3>
                            <ul class="footer-links">
                                <li><a href="#">About Us</a></li>
                                <li><a href="#">Contact Us</a></li>
                                <li><a href="#">Privacy Policy</a></li>
                                <li><a href="#">Orders and Returns</a></li>
                                <li><a href="#">Terms & Conditions</a></li>
                            </ul>
                        </div>
                    </div>

                    <div class="col-md-3 col-xs-6">
                        <div class="footer">
                            <h3 class="footer-title">Service</h3>
                            <ul class="footer-links">
                                <li><a href="#">My Account</a></li>
                                <li><a href="#">View Cart</a></li>
                                <li><a href="wishlist-page.html">Wishlist</a></li>
                                <li><a href="#">Track My Order</a></li>
                                <li><a href="#">Help</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- /row -->
            </div>
            <!-- /container -->
        </div>
        <!-- /top footer -->

        <!-- bottom footer -->
        <div id="bottom-footer" class="section">
            <div class="container">
                <!-- row -->
                <div class="row">
                    <div class="col-md-12 text-center">
                        <ul class="footer-payments">
                            <li><a href="#"><i class="fa fa-cc-visa"></i></a></li>
                            <li><a href="#"><i class="fa fa-credit-card"></i></a></li>
                            <li><a href="#"><i class="fa fa-cc-paypal"></i></a></li>
                            <li><a href="#"><i class="fa fa-cc-mastercard"></i></a></li>
                            <li><a href="#"><i class="fa fa-cc-discover"></i></a></li>
                            <li><a href="#"><i class="fa fa-cc-amex"></i></a></li>
                        </ul>
                        <span class="copyright">
                            Copyright &copy;
                            <script>document.write(new Date().getFullYear());</script> All rights reserved
                        </span>
                    </div>
                </div>
                <!-- /row -->
            </div>
            <!-- /container -->
        </div>
        <!-- /bottom footer -->
    </footer>
    <!-- /FOOTER -->

    <!-- jQuery Plugins -->
    <script src="js/bootstrap.min.js"></script>
    <script src="js/slick.min.js"></script>
    <script src="js/nouislider.min.js"></script>
    <script src="js/jquery.zoom.min.js"></script>
    <script src="js/function.js"></script>
    <script src="js/main.js"></script>

    <script>
        // Wishlist functionality
        // Get wishlist from current user
        function getWishlist() {
            const user = getCurrentUser();
            return user && Array.isArray(user.wishlist) ? user.wishlist : [];
        }
        // Save wishlist to current user
        function saveWishlist(wishlist) {
            const user = getCurrentUser();
            if (user) {
                user.wishlist = wishlist;
                setCurrentUser(user);
            }
            updateWishlistCount();
        }
        // Function to add product to wishlist
        function addToWishlist(productId) {
            const product = JSON.parse(localStorage.getItem(STORAGE_KEYS.ALL_PRODUCTS)).find(p => p.productid === productId);
            if (!product) {
                console.error('Product not found:', productId);
                showCustomAlert('Product not found!', 'error');
                return false;
            }
            const wishlist = getWishlist();
            if (!wishlist.includes(productId)) {
                wishlist.push(productId);
                saveWishlist(wishlist);
                showCustomAlert(`Added ${product.productname} to wishlist!`, 'success');
                return true;
            } else {
                showCustomAlert('Product is already in your wishlist!', 'info');
                return false;
            }
        }
        // Function to remove product from wishlist
        function removeFromWishlist(productId) {
            const product = JSON.parse(localStorage.getItem(STORAGE_KEYS.ALL_PRODUCTS)).find(p => p.productid === productId);
            const wishlist = getWishlist();
            const updatedWishlist = wishlist.filter(id => id !== productId);
            saveWishlist(updatedWishlist);
            showCustomAlert(`Removed ${product.productname} from wishlist!`, 'success');
            loadWishlistItems(); // Reload the wishlist display
        }
        // Function to update wishlist count in header
        function updateWishlistCount() {
            const wishlist = getWishlist();
            const countElement = document.getElementById('wishlist-count');
            if (countElement) {
                countElement.textContent = wishlist.length;
            }
        }
        // CART FUNCTIONALITY (for count only)
        function getCart() {
            const user = getCurrentUser();
            return user && Array.isArray(user.cartItems) ? user.cartItems : [];
        }
        function updateCartCount() {
            const cart = getCart();
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            const countElement = document.getElementById('cart-count');
            if (countElement) {
                countElement.textContent = totalItems;
            }
        }

        // Custom Alert Function
        function showCustomAlert(message, type = 'info') {
            const alertBox = document.getElementById('customAlert');
            const alertIcon = alertBox.querySelector('.alert-icon');
            const alertMessage = alertBox.querySelector('.alert-message');

            // Set message
            alertMessage.textContent = message;

            // Set type and icon
            alertBox.className = `custom-alert ${type}`;

            switch (type) {
                case 'success':
                    alertIcon.className = 'alert-icon fa fa-check-circle';
                    break;
                case 'error':
                    alertIcon.className = 'alert-icon fa fa-times-circle';
                    break;
                case 'info':
                default:
                    alertIcon.className = 'alert-icon fa fa-info-circle';
                    break;
            }

            // Show alert
            alertBox.style.display = 'block';
            setTimeout(() => {
                alertBox.classList.add('show');
            }, 100);

            // Auto hide after 2 seconds
            setTimeout(() => {
                alertBox.classList.remove('show');
                setTimeout(() => {
                    alertBox.style.display = 'none';
                }, 300);
            }, 2000);
        }

        // Generate product image based on type
        function getProductImage(productType, productName = '') {
            if (productType === "CPU") {
                return "cpu.png";
            } else if (productType === "GPU") {
                return "gpu.png";
            } else if (productType === "RAM") {
                return "ram.png";
            } else if (productType === "Device") {
                return "shop01.png";
            } else if (productType === "Storage") {
                if (productName.toLowerCase().includes("ssd")) {
                    return "ssd.png";
                }
                else {
                    return "hdd.png";
                }
            } else {
                return "default.png";
            }
        }

        // Generate star rating HTML
        function generateStarRating(rating) {
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);

            let starsHTML = '';

            // Full stars
            for (let i = 0; i < fullStars; i++) {
                starsHTML += '<i class="fa fa-star"></i>';
            }

            // Half star
            if (hasHalfStar) {
                starsHTML += '<i class="fa fa-star-half-o"></i>';
            }

            // Empty stars
            for (let i = 0; i < emptyStars; i++) {
                starsHTML += '<i class="fa fa-star-o"></i>';
            }

            return starsHTML;
        }

        // Open quick view modal
        function openQuickView(productId) {
            const product = dataSource.products.find(p => p.productid === productId);
            if (!product) {
                console.error('Product not found:', productId);
                showCustomAlert('Product not found!', 'error');
                return;
            }

            currentProductData = product;

            // Determine image based on product type
            let img = getProductImage(product.producttypename, product.productname);

            // Populate modal with product data
            document.getElementById('modalProductImg').src = `./img/${img}`;
            document.getElementById('modalProductName').textContent = product.productname || '';
            document.getElementById('modalProductCategory').textContent = product.categoryname || '';
            document.getElementById('modalProductPrice').textContent = product.finalprice != null ? '৳' + product.finalprice.toFixed(2) : '';
            document.getElementById('modalProductDescription').textContent = product.description || '';
            document.getElementById('modalProductBrand').textContent = product.brandname || 'N/A';
            document.getElementById('modalProductType').textContent = product.producttypename || 'N/A';
            document.getElementById('modalProductCategoryFull').textContent = product.categoryname || 'N/A';
            document.getElementById('modalProductOriginalPrice').textContent = product.salesprice != null ? '৳' + product.salesprice.toFixed(2) : 'N/A';
            document.getElementById('modalProductFinalPrice').textContent = product.finalprice != null ? '৳' + product.finalprice.toFixed(2) : 'N/A';
            document.getElementById('modalProductDiscount').textContent = product.discountprice ? '৳' + product.discountprice.toFixed(2) : 'N/A';

            // Populate rating stars
            const rating = product.rating || 0;
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);

            let starsHTML = '';

            // Full stars
            for (let i = 0; i < fullStars; i++) {
                starsHTML += '<i class="fa fa-star"></i>';
            }

            // Half star
            if (hasHalfStar) {
                starsHTML += '<i class="fa fa-star-half-o"></i>';
            }

            // Empty stars
            for (let i = 0; i < emptyStars; i++) {
                starsHTML += '<i class="fa fa-star-o"></i>';
            }

            starsHTML += `<span style="margin-left: 5px; font-size: 14px; color: #666;">(${rating.toFixed(1)})</span>`;

            document.getElementById('modalProductRating').innerHTML = starsHTML;

            // Show the modal
            $('#quickViewModal').modal('show');
        }

        // Add to cart from modal
        function addToCartFromModal() {
            if (currentProductData) {
                addToCartAndRemoveFromWishlist(currentProductData.productid);
                $('#quickViewModal').modal('hide');
            }
        }

        // Add to cart and remove from wishlist (single alert)
        function addToCartAndRemoveFromWishlist(productId) {
            const added = addToCart(productId);
            if (added) {
                // Remove from wishlist silently (no alert)
                const wishlist = getWishlist();
                const updatedWishlist = wishlist.filter(id => id !== productId);
                const user = getCurrentUser();
                if (user) {
                    user.wishlist = updatedWishlist;
                    setCurrentUser(user);
                }
                updateWishlistCount();
                loadWishlistItems();
            }
        }

        // Add to compare (placeholder function)
        function addToCompare(productId) {
            const product = dataSource.products.find(p => p.productid === productId);
            if (product) {
                showCustomAlert(`Added ${product.productname} to compare list!`, 'success');
                console.log('Added to compare:', product);
                return true;
            }
            showCustomAlert('Product not found!', 'error');
            return false;
        }

        // Function to populate header search categories from dataSource
        function populateHeaderCategories() {
            const categorySelect = document.getElementById('search-category');
            if (categorySelect && dataSource.categories) {
                dataSource.categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category.category_id;
                    option.textContent = category.categoryname;
                    categorySelect.appendChild(option);
                });
            }
        }

        // Function to perform search and redirect to store page
        function performSearch(event) {
            event.preventDefault();

            const searchTerm = document.getElementById('header-search-input').value.trim();
            const selectedCategory = document.getElementById('search-category').value;

            // Build URL with search parameters
            let url = 'store.html';
            const params = new URLSearchParams();

            if (searchTerm) {
                params.append('search', searchTerm);
            }

            if (selectedCategory) {
                params.append('category', selectedCategory);
            }

            // Add parameters to URL if any exist
            if (params.toString()) {
                url += '?' + params.toString();
            }

            // Redirect to store page with search parameters
            window.location.href = url;
        }

        // Function to load and display wishlist items
        function loadWishlistItems() {
            const wishlist = getWishlist();
            const container = document.getElementById('wishlist-container');

            console.log('Loading wishlist items:', wishlist);

            if (wishlist.length === 0) {
                container.innerHTML = `
                    <div class="col-12">
                        <div class="wishlist-empty">
                            <i class="fa fa-heart-o"></i>
                            <h3>Your wishlist is empty</h3>
                            <p>Start adding products to your wishlist to see them here</p>
                            <a href="store.html" class="btn-shop-now">Shop Now</a>
                        </div>
                    </div>
                `;
                return;
            }

            // Filter products from dataSource that are in wishlist
            const wishlistProducts = dataSource.products.filter(product =>
                wishlist.includes(product.productid)
            );

            console.log('Wishlist products found:', wishlistProducts.length);

            if (wishlistProducts.length === 0) {
                container.innerHTML = `
                    <div class="col-12">
                        <div class="wishlist-empty">
                            <i class="fa fa-heart-o"></i>
                            <h3>No products found</h3>
                            <p>Some products in your wishlist may no longer be available</p>
                            <a href="store.html" class="btn-shop-now">Shop Now</a>
                        </div>
                    </div>
                `;
                return;
            }

            // Generate HTML for wishlist products
            let html = '';
            wishlistProducts.forEach(product => {
                let img = getProductImage(product.producttypename, product.productname);

                html += `
                    <div class="col-md-4 col-xs-6">
                        <div class="product">
                            <button class="remove-from-wishlist" onclick="removeFromWishlist('${product.productid}')" title="Remove from wishlist">
                                <i class="fa fa-times"></i>
                            </button>
                            <div class="product-img">
                                <img style="width: 260px; height: 200px; object-fit: cover; border-radius: 8px;" src="./img/${img}" alt="">
                                <div class="product-label">
                                    ${(() => {
                        if (product.product_created_on) {
                            const addedDate = new Date(product.product_created_on);
                            const today = new Date();
                            return (addedDate.getFullYear() === today.getFullYear() &&
                                addedDate.getMonth() === today.getMonth() &&
                                addedDate.getDate() === today.getDate())
                                ? '<span class="new">NEW</span>' : '';
                        }
                        return '';
                    })()}
                                </div>
                            </div>
                            <div class="product-body">
                                <p class="product-category">${product.categoryname || ''}</p>
                                <h3 class="product-name"><a href="#">${product.productname || ''}</a></h3>
                                <p class="product-description" style="min-height:40px;font-size:13px;color:#666;margin-bottom:8px;">${product.description || ''}</p>
                                <h4 class="product-price">${product.finalprice != null ? '৳' + product.finalprice.toFixed(2) : ''}</h4>
                                <div class="product-rating">
                                    ${generateStarRating(product.rating || 0)}
                                    <span style="margin-left: 5px; font-size: 12px; color: #666;">(${product.rating ? product.rating.toFixed(1) : '0.0'})</span>
                                </div>
                                <div class="product-btns">
                                    <button class="add-to-compare" onclick="addToCompare('${product.productid}')" title="Add to compare">
                                        <i class="fa fa-exchange"></i>
                                    </button>
                                    <button class="quick-view" onclick="openQuickView('${product.productid}')" title="Quick view">
                                        <i class="fa fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="add-to-cart1" style="position:relative;">
                                <button class="add-to-cart-btn" onclick="addToCartAndRemoveFromWishlist('${product.productid}')">
                                    <i class="fa fa-shopping-cart"></i> add to cart
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });

            console.log('Generated HTML length:', html.length);
            container.innerHTML = html;

            // Check if add-to-cart buttons are present
            const addToCartButtons = container.querySelectorAll('.add-to-cart');
            console.log('Add to cart buttons found:', addToCartButtons.length);

            // Show add-to-cart on hover
            // const productDivs = container.querySelectorAll('.product');
            // productDivs.forEach(div => {
            //     div.addEventListener('mouseenter', function() {
            //         const atc = div.querySelector('.add-to-cart');
            //         if (atc) atc.style.display = 'block';
            //     });
            //     div.addEventListener('mouseleave', function() {
            //         const atc = div.querySelector('.add-to-cart');
            //         if (atc) atc.style.display = 'none';
            //     });
            // });
        }

        // Initialize page when document is ready
        $(document).ready(function () {
            // Check if dataSource is loaded
            if (typeof dataSource === 'undefined' || !dataSource.products) {
                console.error('dataSource not loaded properly');
                showCustomAlert('Error: Product data not loaded. Please refresh the page.', 'error');
                return;
            }

            console.log('dataSource loaded successfully with', dataSource.products.length, 'products');

            // Populate header categories
            populateHeaderCategories();

            // Update wishlist count
            updateWishlistCount();

            // Update cart count
            updateCartCount();

            // Load wishlist items
            loadWishlistItems();
        });

        // Test function to add a product to wishlist for testing
        function testAddToWishlist() {
            if (dataSource.products.length > 0) {
                const testProduct = dataSource.products[0];
                addToWishlist(testProduct.productid);
                console.log('Added test product to wishlist:', testProduct.productname);
            }
        }

        // Test function to check wishlist status
        function testWishlistStatus() {
            const wishlist = getWishlist();
            console.log('Current wishlist:', wishlist);
            console.log('Wishlist count:', wishlist.length);
            console.log('dataSource products:', dataSource.products.length);
        }

        // Handle cart click - redirect to checkout if cart has items
        function handleCartClick(event) {
            const cart = getCart();
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            event.preventDefault();
            event.stopPropagation();
            if (totalItems > 0) {
                // Redirect to checkout page
                window.location.href = 'checkout.html';
            }
            else {
                // Show custom modal saying cart is empty
                showCustomAlert('Your cart is empty!', 'info');
            }
        }

        function updateAuthLink() {
            const userId = getCurrentUserId();
            const authLink = document.getElementById('auth-link');
            if (!authLink) return;
            if (userId) {
                authLink.innerHTML = '<i class="fa fa-user-o"></i> Logout';
                authLink.href = '#';
                authLink.onclick = function (e) {
                    e.preventDefault();
                    removeCurrentUserId();
                    window.location.href = 'login.html?returnUrl=' + encodeURIComponent(window.location.pathname + window.location.search);
                };
            } else {
                authLink.innerHTML = '<i class="fa fa-user-o"></i> LogIn';
                authLink.href = 'login.html?returnUrl=' + encodeURIComponent(window.location.pathname + window.location.search);
                authLink.onclick = null;
            }
        }
        document.addEventListener('DOMContentLoaded', updateAuthLink);

        // Add product to cart
        function addToCart(productId, quantity = 1) {
            const product = dataSource.products.find(p => p.productid === productId);
            if (!product) {
                console.error('Product not found:', productId);
                showCustomAlert('Product not found!', 'error');
                return false;
            }
            const cart = getCart();
            const existingItem = cart.find(item => item.productId === productId);
            if (existingItem) {
                existingItem.quantity += quantity;
            } else {
                cart.push({
                    productId: productId,
                    quantity: quantity,
                    addedAt: new Date().toISOString()
                });
            }
            saveCart(cart);
            showCustomAlert(`Added ${product.productname} to cart!`, 'success');
            return true;
        }

        // Save cart to current user
        function saveCart(cart) {
            const user = getCurrentUser();
            if (user) {
                user.cartItems = cart;
                setCurrentUser(user);
            }
            updateCartCount();
        }
    </script>
</body>

</html>